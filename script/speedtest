#!/data/data/com.termux/files/usr/bin/bash

# Warna
CYAN='\033[1;36m'
GREEN='\033[1;32m'
YELLOW='\033[1;33m'
RED='\033[1;31m'
RESET='\033[0m'

divider() {
    echo -e "${CYAN}────────────────────────────────────────────${RESET}"
}

banner() {
    echo -e "${CYAN}┌────────────────────────────────────────┐"
    echo -e "${CYAN}│        ⚡ INTERNET SPEED TEST         │"
    echo -e "${CYAN}└────────────────────────────────────────┘${RESET}"
}

# Cek & install speedtest-cli jika belum ada
if ! command -v speedtest >/dev/null 2>&1; then
    echo -e "${YELLOW}[!] speedtest-cli belum terinstal. Menginstal...${RESET}"
    pkg update -y >/dev/null && pkg install python -y >/dev/null
    pip install speedtest-cli >/dev/null
    echo -e "${GREEN}[✓] speedtest-cli berhasil diinstal.${RESET}"
    sleep 1
fi

clear
banner
divider

echo -e "${GREEN}[+] Menjalankan speedtest...${RESET}\n"

# Jalankan speedtest dan tangkap hasil
output=$(speedtest --secure --simple 2>/dev/null)

# Tampilkan hasil dengan warna
download=$(echo "$output" | grep "Download" | awk '{print $2, $3}')
upload=$(echo "$output" | grep "Upload" | awk '{print $2, $3}')
ping=$(echo "$output" | grep "Ping" | awk '{print $2, $3}')

if [[ -z "$download" || -z "$upload" ]]; then
    echo -e "${RED}[✘] Gagal menjalankan speedtest.${RESET}"
else
    echo -e "${CYAN}[↪] Ping:     ${GREEN}$ping${RESET}"
    echo -e "${CYAN}[⬇] Download: ${GREEN}$download${RESET}"
    echo -e "${CYAN}[⬆] Upload:   ${GREEN}$upload${RESET}"
fi

divider
echo -e "${CYAN}[↩] Tekan Enter untuk keluar...${RESET}"
read
